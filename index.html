<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive GDP Map</title>

  <!-- amCharts 5 -->
  <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>

  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      font-family: sans-serif;
    }
    #chartdiv {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="chartdiv"></div>

  <script>
    // Create root and map
    const root = am5.Root.new("chartdiv");

    const chart = root.container.children.push(
      am5map.MapChart.new(root, {
        panX: "rotateX",
        panY: "translateY",
        projection: am5map.geoNaturalEarth1()
      })
    );

    chart.set("zoomControl", am5map.ZoomControl.new(root, {}));

    const polygonSeries = chart.series.push(
      am5map.MapPolygonSeries.new(root, {
        geoJSON: am5geodata_worldLow,
        exclude: ["AQ"],
        valueField: "value",
        calculateAggregates: true
      })
    );

    // Heatmap color settings
    polygonSeries.set("heatRules", [{
      target: polygonSeries.mapPolygons.template,
      dataField: "value",
      min: am5.color(0xe0f7fa),
      max: am5.color(0x006064),
      key: "fill"
    }]);

    // Tooltip on hover
    polygonSeries.mapPolygons.template.setAll({
      tooltipText: "{name}: [bold]{value.formatNumber('#,###.')} B $[/]",
      interactive: true
    });

    polygonSeries.mapPolygons.template.states.create("hover", {
      fill: am5.color(0xff5722)
    });

    // Load data from JSON
    fetch("data.json")
      .then(response => response.json())
      .then(data => {
        polygonSeries.data.setAll(data);
      })
      .catch(error => {
        console.error("Error loading data:", error);
      });
  </script>
</body>
</html>
